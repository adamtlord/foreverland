{% extends 'base_fidouche.html' %}
{% load custom_tags %}
{% load humanize %}
{% block content %}
	<h2>{{ tour }} <small>{{ tour.date_range }}</small></h2>
	<hr>
	<div class="row">
		<div class="col-sm-6">
			<h3>Shows</h3>
			<table class="table table-striped table-bordered">
				<tbody>
				{% for show in tour.shows %}
					<tr>
						<td>
							<a href="{% url 'gig_finances' show.id %}">{{ show }}</a>
						</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
		</div>
		<div class="col-sm-6">
			MAP
		</div>
	</div>
	<hr>
	<h3>Tour Expenses <i class="fa fa-question-circle popover-trigger"
        data-toggle="popover"
        data-content="Expenses related to the whole tour, not a particular show. Tour expenses will be distributed evenly among shows for reporting purposes.">
    </i></h3>
	<form>
		<fieldset>
			{{ expense_formset.management_form }}
			{{ expense_formset.non_form_errors.as_ul }}
			<table id="expenses_formset" class="table table-striped">
				<thead>
					<tr>
						<th width="160">Date</th>
						<th>Payee</th>
						<th>Category</th>
						<th>Amount</th>
						<th>Check #</th>
						<th>Notes</th>
						<th width="100">Receipt</th>
						<th>Delete</th>
					</tr>
				</thead>
				<tbody>
				{% for form in expense_formset.forms %}
					<tr>
						{{ form.id }}
						<td>
							<div class="expense_date_picker input-group">
								{{ form.date }}
								<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
							</div>
						</td>
						<td class="payee">{{ form.payee }}{{ form.errors }}</td>
						<td class="category">{{ form.category }}</td>
						<td class="expense-amount">{{ form.amount }}</td>
						<td>{{ form.check_no }}</td>
						<td>{{ form.notes }}</td>
						<td>{{ form.receipt_img }}</td>
						<td>{{ form.DELETE }}</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
			<button type="button" id="add_expense_rows" class="btn btn-sm btn-default pull-right"><i class="fa fa-plus"></i> Add a row</button>
		</fieldset>
		<button type="submit" class="btn btn-block btn-lg btn-primary">Save</button>
	</form>
{% endblock %}
{% block js %}
<script>
	$(function(){
		$('.popover-trigger').popover();
	});
</script>
{% endblock %}
